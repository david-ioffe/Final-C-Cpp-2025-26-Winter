name: Release Exam

on:
  workflow_dispatch:

jobs:
  release:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Install GitHub CLI
        run: |
          sudo apt update
          sudo apt install gh -y

      - name: Authenticate
        run: echo "${{ secrets.ORG_TOKEN }}" | gh auth login --with-token

      - name: Fix line endings
        run: |
          sudo apt-get update
          sudo apt-get install -y dos2unix
          dos2unix exam-admin/release_exam.sh

      - name: Run release script
        run: bash exam-admin/release_exam.sh
